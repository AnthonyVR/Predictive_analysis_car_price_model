
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>5. Neural Network &#8212; Anthony Van Roost - Car price prediction - Predictive analytics (UCLL)</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="4. Machine learning fundamental methods" href="cars_predictive_analysis_project-Copy6.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Anthony Van Roost - Car price prediction - Predictive analytics (UCLL)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="cars_predictive_analysis_project-Copy2.html">
   1. Reading and taking a look at the data
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="cars_predictive_analysis_project-Copy3.html">
   2. Data Preparation and processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cars_predictive_analysis_project-Copy5.html">
   3. Exploration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cars_predictive_analysis_project-Copy6.html">
   4. Machine learning fundamental methods
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   5. Neural Network
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/cars_predictive_analysis_project-Copy7.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fcars_predictive_analysis_project-Copy7.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/cars_predictive_analysis_project-Copy7.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>5. Neural Network</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="neural-network">
<h1>5. Neural Network<a class="headerlink" href="#neural-network" title="Permalink to this headline">¶</a></h1>
<p><strong>I know this is beyond the scope of the course, but I’ve been learning about neural networks out of interest lately and I wanted to try building one to test myself on this subject. Before I started, I realized that this model would probably perform worse than the more fundamental methods, but that was not the goal. The goal was to learn something and have fun, which I most certainly did.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">layers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-01-25 08:48:08.662186: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library &#39;libcudart.so.11.0&#39;; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory
2022-01-25 08:48:08.662263: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
</pre></div>
</div>
</div>
</div>
<p>Some minor errors and warnings, nothing to worry about.</p>
<p><strong>Let’s first build a model using Keras library. I have a laptop without a gpu, so my neural network will have to train on my cpu. Also I don’t have many days left to train my model so I will definetely have to make some sacrifices on performance.</strong></p>
<p><strong>First of all I made the choice to use only 3 layers (1 hidden layer), otherwise training would take much to long.</strong></p>
<p><strong>For my activation functions on the first 2 layers, I chose for ReLU, as it is a fast yet quite reliable choice for regression. as my third layer only has 1 neuron with a single value, I did not need an activation function for that.</strong></p>
<p><strong>With my optimizer and loss functions, I didn’t go to fancy either, I mainly needed a fast and simple functions. Furthermore, mse is often a good choice for ‘simple’ regression tasks.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">build_model</span><span class="p">():</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">keys</span><span class="p">())]),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">])</span>
    
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">RMSprop</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
    
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">,</span>
                 <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
                 <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">,</span> <span class="s1">&#39;mse&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">model</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">build_model</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_7359</span><span class="o">/</span><span class="mf">1335155156.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">model</span> <span class="o">=</span> <span class="n">build_model</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;build_model&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p><strong>(I accidentally tried running this cell again after training my model but I didn’t want to run everything over again so that it why it now says build_model not found, before this worked ofcourse.)</strong></p>
<p><strong>Let’s have a look at our model now</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model: &quot;sequential&quot;
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense (Dense)               (None, 64)                384       
                                                                 
 dense_1 (Dense)             (None, 64)                4160      
                                                                 
 dense_2 (Dense)             (None, 1)                 65        
                                                                 
=================================================================
Total params: 4,609
Trainable params: 4,609
Non-trainable params: 0
_________________________________________________________________
</pre></div>
</div>
</div>
</div>
<p><strong>Looks good, now let’s test if our model is set up correctly by testing it on a small subset of the data.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_batch</span> <span class="o">=</span> <span class="n">train</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">example_result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">example_batch</span><span class="p">)</span>
<span class="n">example_result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.05787908],
       [ 0.18334435],
       [ 0.37936437],
       [ 0.2206813 ],
       [ 0.10483198],
       [-0.07229923],
       [-0.0250116 ],
       [ 0.1843274 ],
       [ 0.08441111],
       [ 0.20493421]], dtype=float32)
</pre></div>
</div>
</div>
</div>
<p><strong>Everything seems to work fine, let’s train the model now.</strong></p>
<p><strong>As this will take hours, I used a printDot() function to print a dot on every iteration of training, to make sure the training is still busy.</strong></p>
<p><strong>Then I started training the model with 1000 epochs</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#train the model</span>
<span class="k">class</span> <span class="nc">PrintDot</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">Callback</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">on_epoch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">logs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">epoch</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">pr</span> 
              <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            
<span class="n">EPOCHS</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">EPOCHS</span><span class="p">,</span> <span class="n">validation_split</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">PrintDot</span><span class="p">()])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
....................................................................................................
</pre></div>
</div>
</div>
</div>
<p><strong>Done, this took about 3 hours to train already, so unfortunately I won’t have the time to tweak a lot with my loss-, activation-, and optimizer functions. Let’s hold on to the basics.</strong></p>
<p><strong>Let’s now check the results of our last training iterations.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">)</span>
<span class="n">hist</span><span class="p">[</span><span class="s1">&#39;epoch&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">epoch</span>
<span class="n">hist</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>loss</th>
      <th>mae</th>
      <th>mse</th>
      <th>val_loss</th>
      <th>val_mae</th>
      <th>val_mse</th>
      <th>epoch</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>995</th>
      <td>15706116.0</td>
      <td>2616.107178</td>
      <td>15706116.0</td>
      <td>16305415.0</td>
      <td>2645.844971</td>
      <td>16305415.0</td>
      <td>995</td>
    </tr>
    <tr>
      <th>996</th>
      <td>15697392.0</td>
      <td>2615.675049</td>
      <td>15697392.0</td>
      <td>16330255.0</td>
      <td>2640.858887</td>
      <td>16330255.0</td>
      <td>996</td>
    </tr>
    <tr>
      <th>997</th>
      <td>15704668.0</td>
      <td>2615.661133</td>
      <td>15704668.0</td>
      <td>16375983.0</td>
      <td>2636.772461</td>
      <td>16375983.0</td>
      <td>997</td>
    </tr>
    <tr>
      <th>998</th>
      <td>15655734.0</td>
      <td>2613.237061</td>
      <td>15655734.0</td>
      <td>16355840.0</td>
      <td>2653.677979</td>
      <td>16355840.0</td>
      <td>998</td>
    </tr>
    <tr>
      <th>999</th>
      <td>15655700.0</td>
      <td>2614.472900</td>
      <td>15655700.0</td>
      <td>16400591.0</td>
      <td>2652.961670</td>
      <td>16400591.0</td>
      <td>999</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>To compare these results with our other predictive models, I decided to calcultate the rmse from the mse column, by taking the square root.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hist</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hist</span><span class="p">[</span><span class="s1">&#39;mse&#39;</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">hist</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>loss</th>
      <th>mae</th>
      <th>mse</th>
      <th>val_loss</th>
      <th>val_mae</th>
      <th>val_mse</th>
      <th>epoch</th>
      <th>rmse</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>252111808.0</td>
      <td>12809.167969</td>
      <td>252111808.0</td>
      <td>43941684.0</td>
      <td>4920.054688</td>
      <td>43941684.0</td>
      <td>0</td>
      <td>15878.029097</td>
    </tr>
    <tr>
      <th>1</th>
      <td>33763576.0</td>
      <td>4027.907959</td>
      <td>33763576.0</td>
      <td>26813236.0</td>
      <td>3530.665283</td>
      <td>26813236.0</td>
      <td>1</td>
      <td>5810.643338</td>
    </tr>
    <tr>
      <th>2</th>
      <td>25565760.0</td>
      <td>3350.553711</td>
      <td>25565760.0</td>
      <td>23330678.0</td>
      <td>3242.599609</td>
      <td>23330678.0</td>
      <td>2</td>
      <td>5056.259487</td>
    </tr>
    <tr>
      <th>3</th>
      <td>23724400.0</td>
      <td>3195.875732</td>
      <td>23724400.0</td>
      <td>22420352.0</td>
      <td>3152.117676</td>
      <td>22420352.0</td>
      <td>3</td>
      <td>4870.769960</td>
    </tr>
    <tr>
      <th>4</th>
      <td>23093154.0</td>
      <td>3147.664795</td>
      <td>23093154.0</td>
      <td>22037216.0</td>
      <td>3134.419189</td>
      <td>22037216.0</td>
      <td>4</td>
      <td>4805.533685</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>15706116.0</td>
      <td>2616.107178</td>
      <td>15706116.0</td>
      <td>16305415.0</td>
      <td>2645.844971</td>
      <td>16305415.0</td>
      <td>995</td>
      <td>3963.094246</td>
    </tr>
    <tr>
      <th>996</th>
      <td>15697392.0</td>
      <td>2615.675049</td>
      <td>15697392.0</td>
      <td>16330255.0</td>
      <td>2640.858887</td>
      <td>16330255.0</td>
      <td>996</td>
      <td>3961.993438</td>
    </tr>
    <tr>
      <th>997</th>
      <td>15704668.0</td>
      <td>2615.661133</td>
      <td>15704668.0</td>
      <td>16375983.0</td>
      <td>2636.772461</td>
      <td>16375983.0</td>
      <td>997</td>
      <td>3962.911556</td>
    </tr>
    <tr>
      <th>998</th>
      <td>15655734.0</td>
      <td>2613.237061</td>
      <td>15655734.0</td>
      <td>16355840.0</td>
      <td>2653.677979</td>
      <td>16355840.0</td>
      <td>998</td>
      <td>3956.732743</td>
    </tr>
    <tr>
      <th>999</th>
      <td>15655700.0</td>
      <td>2614.472900</td>
      <td>15655700.0</td>
      <td>16400591.0</td>
      <td>2652.961670</td>
      <td>16400591.0</td>
      <td>999</td>
      <td>3956.728447</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 8 columns</p>
</div></div></div>
</div>
<p><strong>Not great, but understandable with only one hidden layer.</strong></p>
<p><strong>Now let’s use the EarlyStopping()function from Keras library to automatically find out at how many epochs the model doesn’t improve anymore and can stop.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">early_stop</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">EPOCHS</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">EPOCHS</span><span class="p">,</span> 
                    <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">early_stop</span><span class="p">,</span> <span class="n">PrintDot</span><span class="p">()])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.....................
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">)</span>
<span class="n">hist</span><span class="p">[</span><span class="s1">&#39;epoch&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">epoch</span>
<span class="n">hist</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hist</span><span class="p">[</span><span class="s1">&#39;mse&#39;</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">hist</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>loss</th>
      <th>mae</th>
      <th>mse</th>
      <th>val_loss</th>
      <th>val_mae</th>
      <th>val_mse</th>
      <th>epoch</th>
      <th>rmse</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>15711818.0</td>
      <td>2614.414307</td>
      <td>15711818.0</td>
      <td>16939938.0</td>
      <td>2730.013184</td>
      <td>16939938.0</td>
      <td>16</td>
      <td>3963.813568</td>
    </tr>
    <tr>
      <th>17</th>
      <td>15723955.0</td>
      <td>2615.282959</td>
      <td>15723955.0</td>
      <td>16436625.0</td>
      <td>2639.060059</td>
      <td>16436625.0</td>
      <td>17</td>
      <td>3965.344247</td>
    </tr>
    <tr>
      <th>18</th>
      <td>15701191.0</td>
      <td>2613.296631</td>
      <td>15701191.0</td>
      <td>17102832.0</td>
      <td>2737.846436</td>
      <td>17102832.0</td>
      <td>18</td>
      <td>3962.472839</td>
    </tr>
    <tr>
      <th>19</th>
      <td>15690877.0</td>
      <td>2615.295410</td>
      <td>15690877.0</td>
      <td>16380891.0</td>
      <td>2633.541992</td>
      <td>16380891.0</td>
      <td>19</td>
      <td>3961.171165</td>
    </tr>
    <tr>
      <th>20</th>
      <td>15656747.0</td>
      <td>2613.933350</td>
      <td>15656747.0</td>
      <td>16787302.0</td>
      <td>2642.258301</td>
      <td>16787302.0</td>
      <td>20</td>
      <td>3956.860751</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Only 20 epochs now, that’s not so much. Impossible to train a neural network with only 20 iterations, tweaking some variables and monitoring another function instead of ‘mse’ would probably help here, but unfortunately time is limited. Maybe one day I’ll optimize this neural network, but for now I’ll call it a day.</strong></p>
<p>Please note that while making this project by myself, I sometimes used (parts) of lines of code from other sources. I do not own these code snippets and I would hereby like to list my code and learning sources:</p>
<p>-Hands-On machine learning with Scikil-Learn, Keras &amp; TensorFlow book and pdf version</p>
<p>-Official wiki pages from all libraries used</p>
<p>-Stackoverflow.com</p>
<p>-Youtube.com</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="cars_predictive_analysis_project-Copy6.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">4. Machine learning fundamental methods</p>
        </div>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Anthony Van Roost<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>